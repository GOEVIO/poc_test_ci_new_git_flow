import { IBillingProfile } from '../interfaces/billingProfile.interface'
import BillingprofilesClientType from '../enums/BillingProfileClientType'

export function getVATandContryCode(billingProfile: IBillingProfile, chargerContryCode: string, countryVAT: number, userZoneVat: number) {
    try {
        const portugueseUser = billingProfile?.billingAddress?.countryCode === "PT";

        if (!portugueseUser && billingProfile.viesVAT) {
            return { VAT: 0, countryCode: chargerContryCode };
        }

        //These values are using the zone because this logic will potentiality soon change soon with the integration of other fiscal entities 
        if (billingProfile.clientType === BillingprofilesClientType.Business && chargerContryCode !== "PT" && portugueseUser) {
            return { VAT: userZoneVat, countryCode: billingProfile?.billingAddress?.countryCode };
        }

        return { VAT: countryVAT, countryCode: chargerContryCode };
    }
    catch (error) {
        console.log(`[function getVATwithViesVAT] error ${error}`)
        return { VAT: countryVAT, countryCode: chargerContryCode };
    }
}